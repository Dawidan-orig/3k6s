Всё, что тут - берётся в основном из тырнета.
Лучше всё попере- #уточнить 

Тут всё работает на случайных числах, вспоминаем теорвер.