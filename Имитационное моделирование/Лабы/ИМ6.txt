	SIMULATE
	REALLOCATE COM,32000

*У 4-го транзакта повышенный приоритет (k=4)
PRIOR FUNCTION P1,E4
1,1/2,1/3,1/4,100

FIRDIST FUNCTION RN1,D3
.2,1/.4,3/1,4

SECDIST FUNCTION RN2,D3
.1,3/.5,5/1,4

THRDIST FUNCTION RN3,D2
.5,5/1,3

CVMTIME FUNCTION P1,E4
1,FN$FIRDIST/2,FN$SECDIST/3,FN$THRDIST/4,2

SVMTIME FUNCTION P1,E4
1,5/2,6/3,4/4,7

*Логика такая:
* Каждый транзакт проходит свой собственный путь благодаря параметрам,
* Но код на всё - один.
* Он динамически создаёт соответствующие транзакту SVM'ы,
* И позволяет здорово уменьшить количество кода, и, главное,
* Сделать его динамическим.

	GENERATE  ,,,1
	SPLIT     3,DEV1,1
DEV1	PRIORITY  FN$PRIOR
DEV2	SEIZE     P1 *Номер устройства - это номер первого параметра в транзакте.
*Такая запись позволяет очень легко и просто расширить количество исп. устройств
	ADVANCE   FN$SVMTIME *предварительная работа
	RELEASE   P1
	QUEUE     QCVM
	PREEMPT   30,PR
	DEPART    QCVM
	ADVANCE   FN$CVMTIME
	RETURN    30
*Возвращаемся в (как бы) соответствующий SVM
	TRANSFER  ,DEV2

	GENERATE  1000
	TERMINATE 1
	START     1
	END